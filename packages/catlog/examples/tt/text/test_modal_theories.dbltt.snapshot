set_theory ThMulticategory
#/ result: set theory to ThMulticategory

type SigMonoid := [
  M : Object,
  op : Multihom[[M, M], M],
  unit : Multihom[[], M]
]
#/ declared: SigMonoid

generate SigMonoid
#/ result: model generated by 1 object and 2 morphisms
#/ M : Object
#/ op : [M, M] -> M : Multihom
#/ unit : [] -> M : Multihom

type SigRig := [
  R : Object,
  Add : SigMonoid & [ .M := R ],
  Mul : SigMonoid & [ .M := R ]
]
#/ declared: SigRig

generate SigRig
#/ result: model generated by 1 object and 4 morphisms
#/ R : Object
#/ Add.op : [R, R] -> R : Multihom
#/ Add.unit : [] -> R : Multihom
#/ Mul.op : [R, R] -> R : Multihom
#/ Mul.unit : [] -> R : Multihom

set_theory ThSymMonoidalCategory
#/ result: set theory to ThSymMonoidalCategory

type SIR := [
  S : Object,
  I : Object,
  R : Object,
  infect : (Hom Object)[@tensor [S, I], @tensor [I, I]],
  recover : (Hom Object)[I, R]
]
#/ declared: SIR

generate SIR
#/ result: model generated by 3 objects and 2 morphisms
#/ S : Object
#/ I : Object
#/ R : Object
#/ infect : ⨂ [S, I] -> ⨂ [I, I] : Hom Object
#/ recover : I -> R : Hom Object

syn [P: SIR] (@tensor [P.S, P.I])
#/ result: @tensor [P.S, P.I] : Object

type SIRV := [
  Unvax : SIR,
  V : Object,
  vaccinate : (Hom Object)[Unvax.S, V]
]
#/ declared: SIRV

generate SIRV
#/ result: model generated by 4 objects and 3 morphisms
#/ Unvax.S : Object
#/ Unvax.I : Object
#/ Unvax.R : Object
#/ V : Object
#/ Unvax.infect : ⨂ [Unvax.S, Unvax.I] -> ⨂ [Unvax.I, Unvax.I] : Hom Object
#/ Unvax.recover : Unvax.I -> Unvax.R : Hom Object
#/ vaccinate : Unvax.S -> V : Hom Object

#(should_fail)
type BadOpApp := [
   X : Object,
   f : (Hom Object)[@tensor X, X],
]
#/ declared: BadOpApp
#/ expected errors:
#/ error[elab]: synthesized type Object does not match expected type List.Symmetric Object:
#/ object types Object and List.Symmetric Object are not equal
#/ --> examples/tt/text/test_modal_theories.dbltt:44:29
#/ 44|    f : (Hom Object)[@tensor X, X],
#/ 44|                             ^

