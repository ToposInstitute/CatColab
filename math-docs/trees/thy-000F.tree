\title{Generalized multicategories}
\taxon{theory}
\import{macros}

\p{The \define{theory of generalized multicategories} is the modal virtual
double theory #{(\dbl{T}, T)} generated by

\ul{
  \li{an object #{x}}
  \li{a proarrow #{p: Tx \proto x}}
}

subject to the relations:

\ul{
  \li{The composite #{Tp \odot p} exists and equals the restriction
  #{p(\mu_x,1_x) = (\mu_x)_! \odot p}.}
  \li{The unit #{\id_x} (which exists by assumption) is equal to the restriction
  #{p(\eta_x,1_x) = (\eta_x)_! \odot p}.}
  \li{The composite #{T^2 p \odot (\mu_x)_!} exists and is equal to the
  restriction #{(Tp)(\mu_{Tx},1_x) = (\mu_{Tx})_! \odot Tp}.}
  \li{The equation between cells holds:
  \quiver{
  % https://q.uiver.app/#q=WzAsMTUsWzAsMCwiVF4zIHgiXSxbMSwwLCJUXjIgeCJdLFsxLDEsIlR4Il0sWzAsMSwiVF4yIHgiXSxbMiwwLCJ4Il0sWzIsMSwieCJdLFsyLDIsIngiXSxbMCwyLCJUXjIgeCJdLFs0LDAsIlReMyB4Il0sWzYsMCwieCJdLFs1LDAsIlReMiB4Il0sWzYsMSwieCJdLFs0LDEsIlReMyB4Il0sWzQsMiwiVF4yIHgiXSxbNiwyLCJ4Il0sWzAsMSwiVF4yIHAiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJiYXJyZWQifX19XSxbMywyLCJUcCIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImJhcnJlZCJ9fX1dLFsxLDIsIlxcbXVfeCIsMV0sWzAsMywiXFxtdV97VHh9IiwyXSxbMSw0LCIoXFxtdV94KV8hIFxcb2RvdCBwIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzQsNSwiIiwwLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMiw1LCJwIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzcsNiwiKFxcbXVfeClfISBcXG9kb3QgcCIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImJhcnJlZCJ9fX1dLFs1LDYsIiIsMix7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzgsMTAsIlReMiBwIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzEwLDksIihcXG11X3gpXyEgXFxvZG90IHAiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJiYXJyZWQifX19XSxbOCwxMiwiIiwyLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMyw3LCIiLDIseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFsxMiwxMSwiKFxcbXVfe1R4fSlfISBcXG9kb3QgKFxcbXVfeClfISBcXG9kb3QgcCIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImJhcnJlZCJ9fX1dLFsxMiwxMywiXFxtdV97VHh9IiwyXSxbOSwxMSwiIiwwLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMTEsMTQsIiIsMCx7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzEzLDE0LCIoXFxtdV94KV8hIFxcb2RvdCBwIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzUsMTIsIj0iLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMTUsMTYsIlxcbXVfcCIsMSx7InNob3J0ZW4iOnsic291cmNlIjoyMCwidGFyZ2V0IjoyMH0sInN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFsyLDIyLCJcXG1hdGhybXtjb21wfSIsMSx7ImxhYmVsX3Bvc2l0aW9uIjo0MCwic2hvcnRlbiI6eyJ0YXJnZXQiOjIwfSwic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzE5LDIxLCJcXG1hdGhybXtyZXN9IiwxLHsic2hvcnRlbiI6eyJzb3VyY2UiOjIwLCJ0YXJnZXQiOjIwfSwic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzEwLDI4LCJcXG1hdGhybXtjb21wfSIsMSx7ImxhYmVsX3Bvc2l0aW9uIjo0MCwic2hvcnRlbiI6eyJ0YXJnZXQiOjIwfSwic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzI4LDMyLCJcXG1hdGhybXtyZXN9IiwxLHsibGFiZWxfcG9zaXRpb24iOjYwLCJzaG9ydGVuIjp7InNvdXJjZSI6MjAsInRhcmdldCI6MjB9LCJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=
  \begin{tikzcd}
	{T^3 x} & {T^2 x} & x && {T^3 x} & {T^2 x} & x \\
	{T^2 x} & Tx & x && {T^3 x} && x \\
	{T^2 x} && x && {T^2 x} && x
	\arrow[""{name=0, anchor=center, inner sep=0}, "{T^2 p}"{inner sep=.8ex}, "\shortmid"{marking}, from=1-1, to=1-2]
	\arrow["{\mu_{Tx}}"', from=1-1, to=2-1]
	\arrow[""{name=1, anchor=center, inner sep=0}, "{(\mu_x)_! \odot p}"{inner sep=.8ex}, "\shortmid"{marking}, from=1-2, to=1-3]
	\arrow["{\mu_x}"{description}, from=1-2, to=2-2]
	\arrow[equals, from=1-3, to=2-3]
	\arrow["{T^2 p}"{inner sep=.8ex}, "\shortmid"{marking}, from=1-5, to=1-6]
	\arrow[equals, from=1-5, to=2-5]
	\arrow["{(\mu_x)_! \odot p}"{inner sep=.8ex}, "\shortmid"{marking}, from=1-6, to=1-7]
	\arrow[equals, from=1-7, to=2-7]
	\arrow[""{name=2, anchor=center, inner sep=0}, "Tp"'{inner sep=.8ex}, "\shortmid"{marking}, from=2-1, to=2-2]
	\arrow[equals, from=2-1, to=3-1]
	\arrow[""{name=3, anchor=center, inner sep=0}, "p"'{inner sep=.8ex}, "\shortmid"{marking}, from=2-2, to=2-3]
	\arrow["{=}"{description}, draw=none, from=2-3, to=2-5]
	\arrow[equals, from=2-3, to=3-3]
	\arrow[""{name=4, anchor=center, inner sep=0}, "{(\mu_{Tx})_! \odot (\mu_x)_! \odot p}"'{inner sep=.8ex}, "\shortmid"{marking}, from=2-5, to=2-7]
	\arrow["{\mu_{Tx}}"', from=2-5, to=3-5]
	\arrow[equals, from=2-7, to=3-7]
	\arrow[""{name=5, anchor=center, inner sep=0}, "{(\mu_x)_! \odot p}"'{inner sep=.8ex}, "\shortmid"{marking}, from=3-1, to=3-3]
	\arrow[""{name=6, anchor=center, inner sep=0}, "{(\mu_x)_! \odot p}"'{inner sep=.8ex}, "\shortmid"{marking}, from=3-5, to=3-7]
	\arrow["{\mu_p}"{description}, draw=none, from=0, to=2]
	\arrow["{\mathrm{res}}"{description}, draw=none, from=1, to=3]
	\arrow["{\mathrm{comp}}"{description, pos=0.4}, draw=none, from=1-6, to=4]
	\arrow["{\mathrm{comp}}"{description, pos=0.4}, draw=none, from=2-2, to=5]
	\arrow["{\mathrm{res}}"{description, pos=0.6}, draw=none, from=4, to=6]
  \end{tikzcd}
  }
  }
}
}

\subtree{
  \title{Interpretation of the axioms}
  \taxon{remark}

  \p{The axioms of the theory of generalized multicategories might seem opaque
  at first glance but intuitively they are just transposes of familiar axioms.
  The first two axioms are transposes of the monad algebra laws, which we might
  write informally as commutative diagrams:
  \quiver{
  % https://q.uiver.app/#q=WzAsNyxbMCwwLCJUXjIgeCJdLFsxLDAsIlR4Il0sWzEsMSwieCJdLFswLDEsIlR4Il0sWzMsMCwieCJdLFs0LDEsIngiXSxbNCwwLCJUeCJdLFswLDEsIlRwIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzEsMiwicCIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImJhcnJlZCJ9fX1dLFswLDMsIihcXG11X3gpXyEiLDIseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJiYXJyZWQifX19XSxbMywyLCJwIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzQsNSwiXFxtYXRocm17aWR9X3giLDIseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJiYXJyZWQifX19XSxbNiw1LCJwIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzQsNiwiKFxcZXRhX3gpXyEiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJiYXJyZWQifX19XV0=
  \begin{tikzcd}
	{T^2 x} & Tx && x & Tx \\
	Tx & x &&& x
	\arrow["Tp"{inner sep=.8ex}, "\shortmid"{marking}, from=1-1, to=1-2]
	\arrow["{(\mu_x)_!}"'{inner sep=.8ex}, "\shortmid"{marking}, from=1-1, to=2-1]
	\arrow["p"{inner sep=.8ex}, "\shortmid"{marking}, from=1-2, to=2-2]
	\arrow["{(\eta_x)_!}"{inner sep=.8ex}, "\shortmid"{marking}, from=1-4, to=1-5]
	\arrow["{\mathrm{id}_x}"'{inner sep=.8ex}, "\shortmid"{marking}, from=1-4, to=2-5]
	\arrow["p"{inner sep=.8ex}, "\shortmid"{marking}, from=1-5, to=2-5]
	\arrow["p"'{inner sep=.8ex}, "\shortmid"{marking}, from=2-1, to=2-2]
  \end{tikzcd}
  }
  The third axiom is the transposed naturality square for the monad
  multiplication at #{p}:
  \quiver{
  % https://q.uiver.app/#q=WzAsNCxbMCwwLCJUXjMgeCJdLFsxLDAsIlReMiB4Il0sWzEsMSwiVHgiXSxbMCwxLCJUXjIgeCJdLFswLDEsIlReMiBwIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiYmFycmVkIn19fV0sWzEsMiwiKFxcbXVfeClfISIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImJhcnJlZCJ9fX1dLFswLDMsIihcXG11X3tUeH0pXyEiLDIseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJiYXJyZWQifX19XSxbMywyLCJUcCIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImJhcnJlZCJ9fX1dXQ==
  \begin{tikzcd}
	{T^3 x} & {T^2 x} \\
	{T^2 x} & Tx
	\arrow["{T^2 p}"{inner sep=.8ex}, "\shortmid"{marking}, from=1-1, to=1-2]
	\arrow["{(\mu_{Tx})_!}"'{inner sep=.8ex}, "\shortmid"{marking}, from=1-1, to=2-1]
	\arrow["{(\mu_x)_!}"{inner sep=.8ex}, "\shortmid"{marking}, from=1-2, to=2-2]
	\arrow["Tp"'{inner sep=.8ex}, "\shortmid"{marking}, from=2-1, to=2-2]
  \end{tikzcd}
  }
  The final axiom is more technical. It ensures that the composition cell
  introduced by the third axiom is (by the universal property of restriction)
  uniquely determined by composition law for the multicategory.
  }
  
}
